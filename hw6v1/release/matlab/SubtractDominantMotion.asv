function mask = SubtractDominantMotion(image1, image2)

% input - image1 and image2 form the input image pair
% output - mask is a binary image of the same size

Rin = imref2d(size(image1));
M = LucasKanadeAffine(image1, image2);
warp_form = affine2d(M');
image2_warped = imwarp(image2, warp_form, 'Linear', 'OutputView', Rin);

threshold = 0.1;
im_diff = abs(image2_warped - image1)) > 0.1;

imshow(rescale(image1))
figure, imshow(rescale( > 0.)